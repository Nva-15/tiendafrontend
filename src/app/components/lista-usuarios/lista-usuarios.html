<div class="container">
    <div class="header">
      <div class="header-top">
        <button class="btn btn-secondary" routerLink="/dashboard">
          Volver al Menú Principal
        </button>
        <h2>Gestión de Usuarios</h2>
        <button class="btn btn-primary" routerLink="/usuarios/nuevo">
          Nuevo Usuario
        </button>
      </div>
      <div class="header-info">
        <p>Total de usuarios: {{ usuariosFiltrados.length }}</p>
      </div>
    </div>
  
    <!-- Filtros -->
    <div class="filtros">
      <div class="filtro-group">
        <label for="filtroEstado">Estado:</label>
        <select id="filtroEstado" [(ngModel)]="filtroEstado" (change)="onFiltroChange()">
          <option *ngFor="let estado of estados" [value]="estado">{{ estado }}</option>
        </select>
      </div>
  
      <div class="filtro-group">
        <label for="filtroRol">Rol:</label>
        <select id="filtroRol" [(ngModel)]="filtroRol" (change)="onFiltroChange()">
          <option *ngFor="let rol of roles" [value]="rol">{{ rol }}</option>
        </select>
      </div>
    </div>
  
    <!-- Loading -->
    <div *ngIf="loading" class="loading">
      <p>Cargando usuarios...</p>
    </div>
  
    <!-- Error -->
    <div *ngIf="error" class="error">
      {{ error }}
    </div>
  
    <!-- Tabla de Usuarios -->
    <div *ngIf="!loading" class="table-container">
      <table class="table">
        <thead>
          <tr>
            <th>#</th>
            <th>Nombre</th>
            <th>Usuario</th>
            <th>Rol</th>
            <th>Estado</th>
            <th>Fecha Creación</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let usuario of usuariosFiltrados; let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{ usuario.nombre }}</td>
            <td>{{ usuario.nombreUsuario }}</td>
            <td>
              <span [class]="getRolBadgeClass(usuario.rol)">{{ usuario.rol }}</span>
            </td>
            <td>
              <span [class]="getEstadoBadgeClass(usuario.estado)">{{ usuario.estado }}</span>
            </td>
            <td>{{ usuario.fechaCreacion | date:'dd/MM/yyyy HH:mm' }}</td>
            <td class="actions">
              <button class="btn btn-edit" [routerLink]="['/usuarios/editar', usuario.id]">
                Editar
              </button>
              <button class="btn btn-status" (click)="cambiarEstadoUsuario(usuario)">
                {{ usuario.estado === 'ACTIVO' ? 'Desactivar' : 'Activar' }}
              </button>
              <button class="btn btn-delete" (click)="eliminarUsuario(usuario.id)">
                Eliminar
              </button>
            </td>
          </tr>
          <tr *ngIf="usuariosFiltrados.length === 0">
            <td colspan="7" class="no-data">No se encontraron usuarios</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>