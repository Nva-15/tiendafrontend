<div class="container">
    <div class="header">
      <h2>Gestión de Usuarios</h2>
      <button class="btn btn-primary" routerLink="/usuarios/nuevo">
        <i class="fas fa-plus"></i> Nuevo Usuario
      </button>
    </div>
  
    <!-- Filtros -->
    <div class="filtros">
      <div class="filtro-group">
        <label for="filtroEstado">Estado:</label>
        <select id="filtroEstado" [(ngModel)]="filtroEstado" (change)="onFiltroChange()">
          <option *ngFor="let estado of estados" [value]="estado">{{ estado }}</option>
        </select>
      </div>
  
      <div class="filtro-group">
        <label for="filtroRol">Rol:</label>
        <select id="filtroRol" [(ngModel)]="filtroRol" (change)="onFiltroChange()">
          <option *ngFor="let rol of roles" [value]="rol">{{ rol }}</option>
        </select>
      </div>
    </div>
  
    <!-- Loading -->
    <div *ngIf="loading" class="loading">
      <p>Cargando usuarios...</p>
    </div>
  
    <!-- Error -->
    <div *ngIf="error" class="error">
      {{ error }}
    </div>
  
    <!-- Tabla de Usuarios -->
    <div *ngIf="!loading" class="table-container">
      <table class="table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>Usuario</th>
            <th>Rol</th>
            <th>Estado</th>
            <th>Fecha Creación</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let usuario of usuariosFiltrados">
            <td>{{ usuario.id }}</td>
            <td>{{ usuario.nombre }}</td>
            <td>{{ usuario.nombreUsuario }}</td>
            <td>
              <span [class]="getRolBadgeClass(usuario.rol)">{{ usuario.rol }}</span>
            </td>
            <td>
              <span [class]="getEstadoBadgeClass(usuario.estado)">{{ usuario.estado }}</span>
            </td>
            <td>{{ usuario.fechaCreacion | date:'dd/MM/yyyy HH:mm' }}</td>
            <td class="actions">
              <button class="btn btn-edit" [routerLink]="['/usuarios/editar', usuario.id]">
                <i class="fas fa-edit"></i> Editar
              </button>
              <button class="btn btn-status" (click)="cambiarEstadoUsuario(usuario)">
                <i class="fas" [class.fa-toggle-on]="usuario.estado === 'ACTIVO'" 
                   [class.fa-toggle-off]="usuario.estado === 'INACTIVO'"></i>
                {{ usuario.estado === 'ACTIVO' ? 'Desactivar' : 'Activar' }}
              </button>
              <button class="btn btn-delete" (click)="eliminarUsuario(usuario.id)">
                <i class="fas fa-trash"></i> Eliminar
              </button>
            </td>
          </tr>
          <tr *ngIf="usuariosFiltrados.length === 0">
            <td colspan="7" class="no-data">No se encontraron usuarios</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>